sequenceDiagram
    actor Bruger as Bruger
    participant EV as EventViewerPage.razor
    participant ES as EventService
    participant ECon as EventController
    participant ERepo as EventRepository
    participant DB as MongoDbContext
    participant TS as TaskService
    participant TCon as TaskController
    participant TRepo as TaskRepository

    %% Forudsætning
    Note over Bruger,EV: Bruger er logget ind i systemet

    %% 2. Bruger navigerer til Events
    Bruger->>EV: (2) Gå til "Events" sektion

    %% 3. Systemet indlæser events
    EV->>ES: (3.1) HentAlleEvents()
    ES->>ECon: (3.2) GET /event (Hent alle events)
    ECon->>ERepo: (3.3) GetAllAsync()
    ERepo->>DB: (3.4) Hent events
    DB-->>ERepo: (3.5) Return events liste
    ERepo-->>ECon: (3.6) Return events liste
    ECon-->>ES: (3.7) Return events liste
    ES-->>EV: (3.8) Return events liste

    Note right of EV: Viser liste med: Titel, Dato, Lokation,<br/>Kundenavn, Madvalg, Særlige ønsker, Antal deltagere

    %% 4. Brugeren vælger specifikt event
    Bruger->>EV: (4.1) Klik på specifikt event
    EV->>ES: (4.2) GetEventById(eventId)
    ES->>ECon: (4.3) GET /event/{id}
    ECon->>ERepo: (4.4) GetByIdAsync(eventId)
    ERepo->>DB: (4.5) Hent event baseret på ID
    DB-->>ERepo: (4.6) Return event data
    ERepo-->>ECon: (4.7) Return event data
    ECon-->>ES: (4.8) Return event data
    ES-->>EV: (4.9) Return event detaljer

    %% 5. Systemet viser event detaljer og tilknyttede opgaver (5.1, 5.2 osv.)
    EV->>TS: (5.1) Hent opgaver for event (GetTasksByEventId(eventId))
    TS->>TCon: (5.2) GET /task/byevents/{eventId}
    TCon->>TRepo: (5.3) GetTasksByEventIdsAsync(eventId)
    TRepo->>DB: (5.4) Find tilknyttede opgaver
    DB-->>TRepo: (5.5) Return opgaveliste
    TRepo-->>TCon: (5.6) Return opgaveliste
    TCon-->>TS: (5.7) Return opgaveliste
    TS-->>EV: (5.8) Return opgaveliste

    Note right of EV: Viser event detaljer inkl. Titel, Beskrivelse,<br/>Dato, Start/Slut, Status og tildelte medarbejdere

    %% Undtagelsesflow: Systemet kan ikke indlæse events (fx 3.x fejl)
    alt Systemfejl ved event indlæsning
        ES-->>EV: (3.x Fejl) Return fejlbesked
        EV-->>Bruger: Viser fejlbesked om manglende event-oversigt
    end
